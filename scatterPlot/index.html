<!DOCTYPE html>
<html>
	<head>
  <meta charset="utf-8">

		<style>
		.regression {
		  stroke-width: 2px;
		  stroke: Blue;
		}
		.equation {
			font-size: 12px;
			margin-top: 10px;
			text-align: center;
		}
		</style>

	</head>
<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>

<!-- Create a div where the graph will take place -->
<div id="main_div">
  <h1 style="font-size:20px">
    Unemployment Rate from 2009-2019 seasonally adjusted
  </h1>
  <p>
    <em>The most recent presidents have made significant progress in lowering the unemployment rate.</em>
  </p>
  <p>
    Rate/Percent
    <button onclick="showLine()">Show Regresion Line</button>
    <button onclick="removeLine()">Remove Regresion Line</button>
  </p>
</div>

<script>
  // set the dimensions and margins of the graph
  var margin = {
      top: 10,
      right: 30,
      bottom: 30,
      left: 30
    },
    width = 500 - margin.left - margin.right,
    height = 300 - margin.top - margin.bottom;


  // append the svg object to the body of the page
  var svg = d3.select("#main_div")
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .style("float", "left")
    .append("g")
    .attr("transform",
      "translate(" + margin.left + "," + margin.top + ")");

  //Read the data
  d3.csv("https://raw.githubusercontent.com/robDevs/dataVis/master/scatterPlot/unemployment-data.csv", function(data) {

    var parseTime = d3.timeParse("%Y/%b");
    var formatTime = d3.timeFormat("%b");

    // Add X axis
    var x = d3.scaleTime()
    	.domain([new Date(2009, 0, 1), new Date(2020, 0, 1)])
      .range([0, width]);
      svg.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x));

    // Add Y axis
    var y = d3.scaleLinear()
      .domain([2, 11.00])
      .range([height, 0]);
    svg.append("g")
      .call(d3.axisLeft(y));

    // Add dots
    svg.append('g')
      .selectAll("dot")
      .data(data)
      .enter()
      .append("circle")
      .attr("cx", function(d) { return x(parseTime(d.Date)); })
      .attr("cy", function(d) { return y(d.Rate); })
      .attr("r", 1.5)
      .style("fill", "#000000")
      .append("svg:title")
  		.text(function(d) { return formatTime(parseTime(d.Date)) + " : " + d.Rate; })
  })

      d3.select("body").append("div").attr("class", "stats").style("border", "2px solid black").style("margin-left","510px").style("width", "200px");
      d3.select(".stats").append("b").text("Rate Stats").style("margin-left","10px").style("margin-top", "0px");
      d3.select(".stats").append("br");
      d3.select(".stats").append("em").text("μ: 4.246").style("margin-left","10px").style("margin-top", "0px");
      d3.select(".stats").append("br");
      d3.select(".stats").append("em").text("median: 4.574").style("margin-left","10px").style("margin-top", "0px");
      d3.select(".stats").append("br");
      d3.select(".stats").append("em").text("σ: 2.046").style("margin-left","10px").style("margin-top", "0px");

      d3.select("body").append("p").text("Year").style("margin-left","250px").style("margin-top", "0px").style("clear", "both");
      d3.select("body").append("em").text("U.S. Bureau of Labor Statistics").style("margin-left", "150px");
      d3.select("body").append("br");
      d3.select("body").append("em").text("https://data.bls.gov/timeseries/LNS14000000").style("margin-left", "100px");;

      function showLine() {
  			svg.append("line")
         .attr("class", "regression")
         .attr("x1", 0)
         .attr("y1", 24.54)
         .attr("x2", 406.8359472242968)
         .attr("y2", 236.094692557);
			}

      function removeLine() {
      	svg.selectAll(".regression").remove()
      }

</script>
</html>
